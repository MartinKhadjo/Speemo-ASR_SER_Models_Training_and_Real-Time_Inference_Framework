[DIST] MASTER_ADDR=n23g0027 MASTER_PORT=29500 NNODES=1 GPUS_PER_NODE=1
[PRE] Skipping all preprocessing (skip_preprocessing=on or all per-step toggles are 'on')
[TRAIN][ASR] Starting ASR phase ...
[Setup] Using device: cuda
[Setup] no_cuda flag set to: False
[ASR] Loading model + processor‚Ä¶
[ASR] Starting from pretrained: models/pretrained/en
trainable params: 589,824 || all params: 94,986,144 || trainable%: 0.6210
[ASR] Trainable parameters: 589824 / 94986144
üõ†Ô∏è  Debug collator output shapes: {'input_values': torch.Size([4, 75264]), 'attention_mask': torch.Size([4, 75264]), 'labels': torch.Size([4, 93])}
[ASR] Starting training with HuggingFace Trainer‚Ä¶
n23g0027:146775:146775 [0] NCCL INFO Bootstrap : Using ib0:134.61.46.223<0>
n23g0027:146775:146775 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
n23g0027:146775:146775 [0] NCCL INFO cudaDriverVersion 12080
NCCL version 2.20.5+cuda12.4
n23g0027:146775:147009 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:134.61.46.223<0>
n23g0027:146775:147009 [0] NCCL INFO Using non-device net plugin version 0
n23g0027:146775:147009 [0] NCCL INFO Using network IB
n23g0027:146775:147009 [0] NCCL INFO DMA-BUF is available on GPU device 0
n23g0027:146775:147009 [0] NCCL INFO comm 0x560ce0f6e4b0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x79b0a66c01137ddc - Init START
n23g0027:146775:147009 [0] NCCL INFO comm 0x560ce0f6e4b0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
n23g0027:146775:147009 [0] NCCL INFO Channel 00/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 01/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 02/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 03/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 04/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 05/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 06/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 07/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 08/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 09/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 10/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 11/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 12/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 13/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 14/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 15/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 16/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 17/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 18/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 19/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 20/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 21/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 22/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 23/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 24/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 25/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 26/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 27/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 28/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 29/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 30/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Channel 31/32 :    0
n23g0027:146775:147009 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
n23g0027:146775:147009 [0] NCCL INFO P2P Chunksize set to 131072
n23g0027:146775:147009 [0] NCCL INFO Connected all rings
n23g0027:146775:147009 [0] NCCL INFO Connected all trees
n23g0027:146775:147009 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
n23g0027:146775:147009 [0] NCCL INFO comm 0x560ce0f6e4b0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x79b0a66c01137ddc - Init COMPLETE
{'loss': 2.6533, 'grad_norm': 3.6624484062194824, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 2.0673, 'grad_norm': 1.7898550033569336, 'learning_rate': 4.900000000000001e-07, 'epoch': 0.1}
{'loss': 2.0239, 'grad_norm': 2.7036983966827393, 'learning_rate': 9.85e-07, 'epoch': 0.2}
{'loss': 2.089, 'grad_norm': 2.6052632331848145, 'learning_rate': 1.485e-06, 'epoch': 0.3}
{'loss': 1.9501, 'grad_norm': 3.0562870502471924, 'learning_rate': 1.985e-06, 'epoch': 0.4}
{'loss': 1.8592, 'grad_norm': 1.8618344068527222, 'learning_rate': 2.4850000000000003e-06, 'epoch': 0.5}
{'loss': 1.7435, 'grad_norm': 1.7316662073135376, 'learning_rate': 2.9850000000000002e-06, 'epoch': 0.6}
{'loss': 1.6822, 'grad_norm': 1.9587410688400269, 'learning_rate': 3.485e-06, 'epoch': 0.7}
{'loss': 1.5984, 'grad_norm': 7.48593282699585, 'learning_rate': 3.985000000000001e-06, 'epoch': 0.8}
{'loss': 1.5474, 'grad_norm': 2.3584465980529785, 'learning_rate': 4.48e-06, 'epoch': 0.9}
{'loss': 1.4356, 'grad_norm': 1.4448890686035156, 'learning_rate': 4.980000000000001e-06, 'epoch': 1.0}
{'eval_loss': 1.0832010507583618, 'eval_wer': 0.38496058378608716, 'eval_runtime': 1524.276, 'eval_samples_per_second': 5.248, 'eval_steps_per_second': 5.248, 'epoch': 1.0}
{'loss': 1.3604, 'grad_norm': 3.3816142082214355, 'learning_rate': 5.480000000000001e-06, 'epoch': 1.1}
{'loss': 1.3179, 'grad_norm': 2.8529889583587646, 'learning_rate': 5.98e-06, 'epoch': 1.2}
{'loss': 1.236, 'grad_norm': 1.826560378074646, 'learning_rate': 6.480000000000001e-06, 'epoch': 1.3}
{'loss': 1.234, 'grad_norm': 2.388688564300537, 'learning_rate': 6.98e-06, 'epoch': 1.4}
{'loss': 1.2305, 'grad_norm': 2.2523691654205322, 'learning_rate': 7.48e-06, 'epoch': 1.5}
{'loss': 1.2522, 'grad_norm': 1.5989452600479126, 'learning_rate': 7.980000000000002e-06, 'epoch': 1.6}
{'loss': 1.1348, 'grad_norm': 3.688201427459717, 'learning_rate': 8.48e-06, 'epoch': 1.7}
{'loss': 1.1607, 'grad_norm': 3.0061991214752197, 'learning_rate': 8.98e-06, 'epoch': 1.8}
{'loss': 1.1547, 'grad_norm': 4.889217376708984, 'learning_rate': 9.48e-06, 'epoch': 1.9}
{'loss': 1.0948, 'grad_norm': 3.46579909324646, 'learning_rate': 9.980000000000001e-06, 'epoch': 2.0}
{'eval_loss': 0.846038818359375, 'eval_wer': 0.40224512623841485, 'eval_runtime': 1524.8701, 'eval_samples_per_second': 5.246, 'eval_steps_per_second': 5.246, 'epoch': 2.0}
{'loss': 1.0544, 'grad_norm': 2.6732983589172363, 'learning_rate': 1e-05, 'epoch': 2.1}
{'loss': 1.0524, 'grad_norm': 2.4886555671691895, 'learning_rate': 1e-05, 'epoch': 2.2}
{'loss': 1.0259, 'grad_norm': 2.247027635574341, 'learning_rate': 1e-05, 'epoch': 2.3}
{'loss': 1.0364, 'grad_norm': 2.438253164291382, 'learning_rate': 1e-05, 'epoch': 2.4}
{'loss': 1.0362, 'grad_norm': 5.422224998474121, 'learning_rate': 1e-05, 'epoch': 2.5}
{'loss': 1.0462, 'grad_norm': 3.403952121734619, 'learning_rate': 1e-05, 'epoch': 2.6}
{'loss': 1.0176, 'grad_norm': 4.641577243804932, 'learning_rate': 1e-05, 'epoch': 2.7}
{'loss': 1.0213, 'grad_norm': 5.520201683044434, 'learning_rate': 1e-05, 'epoch': 2.8}
{'loss': 1.0233, 'grad_norm': 2.3727784156799316, 'learning_rate': 1e-05, 'epoch': 2.9}
{'loss': 1.0455, 'grad_norm': 3.0425143241882324, 'learning_rate': 1e-05, 'epoch': 3.0}
{'eval_loss': 0.7714853286743164, 'eval_wer': 0.3991557473101097, 'eval_runtime': 1521.9, 'eval_samples_per_second': 5.257, 'eval_steps_per_second': 5.257, 'epoch': 3.0}
{'train_runtime': 5099.9947, 'train_samples_per_second': 125.459, 'train_steps_per_second': 3.922, 'train_loss': 1.3512527525424958, 'epoch': 3.0}
[ASR][Trainer Eval] {'eval_loss': 0.7714853286743164, 'eval_wer': 0.3991557473101097, 'eval_runtime': 1522.1115, 'eval_samples_per_second': 5.256, 'eval_steps_per_second': 5.256, 'epoch': 3.0}
[SER] Skipped (phase != 'all'/'ser').
n23g0027:146775:147012 [0] NCCL INFO [Service thread] Connection closed by localRank 0
n23g0027:146775:281307 [0] NCCL INFO comm 0x560ce0f6e4b0 rank 0 nranks 1 cudaDev 0 busId 9d000 - Abort COMPLETE
[TRAIN][SER] Starting SER phase ...
[Setup] Using device: cuda
[Setup] no_cuda flag set to: False
[ASR] Skipped (phase != 'all'/'asr').
[SER] Loading model + extractor‚Ä¶
[SER] Starting from pretrained: models/pretrained/en
trainable params: 1,327,104 || all params: 96,295,560 || trainable%: 1.3782
[SER] Trainable parameters: 1327104 / 96295560
[SER] tensors requiring grad: 144
[SER] truncating to 102719 frames (~6.42s)
[SER] class counts: {4: 6792, 7: 1408, 3: 5556, 5: 6384, 0: 6044, 2: 4140, 1: 3500, 6: 768}
[SER] class weights: [0.7154202461242676, 1.2354285717010498, 1.0444444417953491, 0.7782577276229858, 0.6366313099861145, 0.677318274974823, 5.630208492279053, 3.0710227489471436]
[SER] Sanity loss (1 batch): 2.046975612640381
[SER] Starting training with HuggingFace Trainer‚Ä¶
n23g0027:281443:281443 [0] NCCL INFO Bootstrap : Using ib0:134.61.46.223<0>
n23g0027:281443:281443 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
n23g0027:281443:281443 [0] NCCL INFO cudaDriverVersion 12080
NCCL version 2.20.5+cuda12.4
n23g0027:281443:297626 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:134.61.46.223<0>
n23g0027:281443:297626 [0] NCCL INFO Using non-device net plugin version 0
n23g0027:281443:297626 [0] NCCL INFO Using network IB
n23g0027:281443:297626 [0] NCCL INFO DMA-BUF is available on GPU device 0
n23g0027:281443:297626 [0] NCCL INFO comm 0x55b15c9240b0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x1f3f841d24974178 - Init START
n23g0027:281443:297626 [0] NCCL INFO comm 0x55b15c9240b0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
n23g0027:281443:297626 [0] NCCL INFO Channel 00/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 01/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 02/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 03/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 04/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 05/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 06/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 07/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 08/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 09/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 10/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 11/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 12/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 13/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 14/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 15/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 16/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 17/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 18/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 19/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 20/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 21/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 22/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 23/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 24/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 25/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 26/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 27/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 28/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 29/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 30/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Channel 31/32 :    0
n23g0027:281443:297626 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
n23g0027:281443:297626 [0] NCCL INFO P2P Chunksize set to 131072
n23g0027:281443:297626 [0] NCCL INFO Connected all rings
n23g0027:281443:297626 [0] NCCL INFO Connected all trees
n23g0027:281443:297626 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
n23g0027:281443:297626 [0] NCCL INFO comm 0x55b15c9240b0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x1f3f841d24974178 - Init COMPLETE
{'loss': 2.0836, 'grad_norm': 0.06648322194814682, 'learning_rate': 1.1458333333333333e-06, 'epoch': 0.23}
{'loss': 2.0829, 'grad_norm': 0.04604397341609001, 'learning_rate': 2.3032407407407407e-06, 'epoch': 0.46}
{'loss': 2.0862, 'grad_norm': 0.054484348744153976, 'learning_rate': 3.4606481481481487e-06, 'epoch': 0.69}
{'loss': 2.0824, 'grad_norm': 0.0460626482963562, 'learning_rate': 4.618055555555556e-06, 'epoch': 0.93}
{'eval_loss': 2.083970785140991, 'eval_accuracy': 0.10759493670886076, 'eval_f1': 0.021178922980751552, 'eval_runtime': 93.2007, 'eval_samples_per_second': 74.592, 'eval_steps_per_second': 74.592, 'epoch': 1.0}
{'loss': 2.0822, 'grad_norm': 0.08055046200752258, 'learning_rate': 5.775462962962963e-06, 'epoch': 1.16}
{'loss': 2.0797, 'grad_norm': 0.07885682582855225, 'learning_rate': 6.932870370370371e-06, 'epoch': 1.39}
{'loss': 2.077, 'grad_norm': 0.0845676064491272, 'learning_rate': 8.090277777777778e-06, 'epoch': 1.62}
{'loss': 2.0786, 'grad_norm': 0.1454768180847168, 'learning_rate': 9.247685185185185e-06, 'epoch': 1.85}
{'eval_loss': 2.0844764709472656, 'eval_accuracy': 0.10730724971231301, 'eval_f1': 0.029355994987987688, 'eval_runtime': 89.6906, 'eval_samples_per_second': 77.511, 'eval_steps_per_second': 77.511, 'epoch': 2.0}
{'loss': 2.0697, 'grad_norm': 0.14413897693157196, 'learning_rate': 9.954989711934157e-06, 'epoch': 2.08}
{'loss': 2.0626, 'grad_norm': 0.18685199320316315, 'learning_rate': 9.826388888888889e-06, 'epoch': 2.31}
{'loss': 2.054, 'grad_norm': 0.36715129017829895, 'learning_rate': 9.697788065843621e-06, 'epoch': 2.55}
{'loss': 2.0393, 'grad_norm': 0.2831779718399048, 'learning_rate': 9.569187242798355e-06, 'epoch': 2.78}
{'eval_loss': 2.070695638656616, 'eval_accuracy': 0.10658803222094361, 'eval_f1': 0.0852939367826108, 'eval_runtime': 89.8578, 'eval_samples_per_second': 77.367, 'eval_steps_per_second': 77.367, 'epoch': 3.0}
{'train_runtime': 653.121, 'train_samples_per_second': 846.398, 'train_steps_per_second': 13.229, 'train_loss': 2.069724436159487, 'epoch': 3.0}
[SER][Trainer Eval] {'eval_loss': 2.083970785140991, 'eval_accuracy': 0.10759493670886076, 'eval_f1': 0.021178922980751552, 'eval_runtime': 77.4228, 'eval_samples_per_second': 89.793, 'eval_steps_per_second': 89.793, 'epoch': 3.0}
n23g0027:281443:297629 [0] NCCL INFO [Service thread] Connection closed by localRank 0
n23g0027:281443:312659 [0] NCCL INFO comm 0x55b15c9240b0 rank 0 nranks 1 cudaDev 0 busId 9d000 - Abort COMPLETE
