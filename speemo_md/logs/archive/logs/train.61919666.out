[DIST] MASTER_ADDR=r23g0005 MASTER_PORT=29500 NNODES=1 GPUS_PER_NODE=1
[PRE] Skipping all preprocessing (skip_preprocessing=on or all per-step toggles are 'on')
[TRAIN][ASR] Starting ASR phase ...
[Setup] Using device: cuda
[Setup] no_cuda flag set to: False
[ASR] Loading model + processor‚Ä¶
[ASR] Starting from pretrained: models/pretrained/en
trainable params: 589,824 || all params: 94,986,144 || trainable%: 0.6210
[ASR] Trainable parameters: 589824 / 94986144
üõ†Ô∏è  Debug collator output shapes: {'input_values': torch.Size([4, 75264]), 'attention_mask': torch.Size([4, 75264]), 'labels': torch.Size([4, 93])}
[ASR] Starting training with HuggingFace Trainer‚Ä¶
r23g0005:255432:255432 [0] NCCL INFO Bootstrap : Using ib0:134.61.46.209<0>
r23g0005:255432:255432 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
r23g0005:255432:255432 [0] NCCL INFO cudaDriverVersion 12080
NCCL version 2.20.5+cuda12.4
r23g0005:255432:255564 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:134.61.46.209<0>
r23g0005:255432:255564 [0] NCCL INFO Using non-device net plugin version 0
r23g0005:255432:255564 [0] NCCL INFO Using network IB
r23g0005:255432:255564 [0] NCCL INFO DMA-BUF is available on GPU device 0
r23g0005:255432:255564 [0] NCCL INFO comm 0x55cf41eb0b70 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x7434e59f1c5e3246 - Init START
r23g0005:255432:255564 [0] NCCL INFO comm 0x55cf41eb0b70 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
r23g0005:255432:255564 [0] NCCL INFO Channel 00/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 01/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 02/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 03/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 04/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 05/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 06/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 07/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 08/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 09/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 10/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 11/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 12/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 13/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 14/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 15/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 16/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 17/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 18/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 19/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 20/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 21/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 22/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 23/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 24/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 25/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 26/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 27/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 28/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 29/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 30/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Channel 31/32 :    0
r23g0005:255432:255564 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
r23g0005:255432:255564 [0] NCCL INFO P2P Chunksize set to 131072
r23g0005:255432:255564 [0] NCCL INFO Connected all rings
r23g0005:255432:255564 [0] NCCL INFO Connected all trees
r23g0005:255432:255564 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
r23g0005:255432:255564 [0] NCCL INFO comm 0x55cf41eb0b70 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0x7434e59f1c5e3246 - Init COMPLETE
{'loss': 2.6533, 'grad_norm': 3.580399751663208, 'learning_rate': 0.0, 'epoch': 0.0}
{'loss': 2.0675, 'grad_norm': 1.8317062854766846, 'learning_rate': 4.900000000000001e-07, 'epoch': 0.1}
{'loss': 2.0241, 'grad_norm': 2.681004524230957, 'learning_rate': 9.85e-07, 'epoch': 0.2}
{'loss': 2.0892, 'grad_norm': 2.5682547092437744, 'learning_rate': 1.485e-06, 'epoch': 0.3}
{'loss': 1.9512, 'grad_norm': 3.073326349258423, 'learning_rate': 1.985e-06, 'epoch': 0.4}
{'loss': 1.8599, 'grad_norm': 1.8787561655044556, 'learning_rate': 2.4850000000000003e-06, 'epoch': 0.5}
{'loss': 1.742, 'grad_norm': 1.9471033811569214, 'learning_rate': 2.9850000000000002e-06, 'epoch': 0.6}
{'loss': 1.6786, 'grad_norm': 1.9061495065689087, 'learning_rate': 3.485e-06, 'epoch': 0.7}
{'loss': 1.5929, 'grad_norm': 1.7211964130401611, 'learning_rate': 3.985000000000001e-06, 'epoch': 0.8}
{'loss': 1.544, 'grad_norm': 2.3671092987060547, 'learning_rate': 4.485e-06, 'epoch': 0.9}
{'loss': 1.4326, 'grad_norm': 1.8214123249053955, 'learning_rate': 4.9850000000000006e-06, 'epoch': 1.0}
{'eval_loss': 1.0832209587097168, 'eval_wer': 0.3850271652285075, 'eval_runtime': 1518.9107, 'eval_samples_per_second': 5.267, 'eval_steps_per_second': 5.267, 'epoch': 1.0}
{'loss': 1.3581, 'grad_norm': 3.5274064540863037, 'learning_rate': 5.485e-06, 'epoch': 1.1}
{'loss': 1.318, 'grad_norm': 3.3996503353118896, 'learning_rate': 5.985000000000001e-06, 'epoch': 1.2}
{'loss': 1.2357, 'grad_norm': 2.0840020179748535, 'learning_rate': 6.485000000000001e-06, 'epoch': 1.3}
{'loss': 1.2348, 'grad_norm': 2.3368752002716064, 'learning_rate': 6.985000000000001e-06, 'epoch': 1.4}
{'loss': 1.234, 'grad_norm': 3.174293041229248, 'learning_rate': 7.485000000000001e-06, 'epoch': 1.5}
{'loss': 1.2536, 'grad_norm': 1.6475201845169067, 'learning_rate': 7.985e-06, 'epoch': 1.6}
{'loss': 1.1338, 'grad_norm': 2.724458932876587, 'learning_rate': 8.485000000000001e-06, 'epoch': 1.7}
{'loss': 1.1597, 'grad_norm': 7.746926784515381, 'learning_rate': 8.985000000000001e-06, 'epoch': 1.8}
{'loss': 1.1542, 'grad_norm': 5.0226826667785645, 'learning_rate': 9.485000000000002e-06, 'epoch': 1.9}
{'loss': 1.0929, 'grad_norm': 3.253540515899658, 'learning_rate': 9.985000000000002e-06, 'epoch': 2.0}
{'eval_loss': 0.8443771004676819, 'eval_wer': 0.39773090444231385, 'eval_runtime': 1522.6752, 'eval_samples_per_second': 5.254, 'eval_steps_per_second': 5.254, 'epoch': 2.0}
{'loss': 1.0513, 'grad_norm': 3.100179433822632, 'learning_rate': 1e-05, 'epoch': 2.1}
{'loss': 1.0517, 'grad_norm': 2.927577495574951, 'learning_rate': 1e-05, 'epoch': 2.2}
{'loss': 1.0239, 'grad_norm': 2.1447412967681885, 'learning_rate': 1e-05, 'epoch': 2.3}
{'loss': 1.0343, 'grad_norm': 2.914482593536377, 'learning_rate': 1e-05, 'epoch': 2.4}
{'loss': 1.0356, 'grad_norm': 5.992377281188965, 'learning_rate': 1e-05, 'epoch': 2.5}
{'loss': 1.0457, 'grad_norm': 3.5318033695220947, 'learning_rate': 1e-05, 'epoch': 2.6}
{'loss': 1.0168, 'grad_norm': 2.517840623855591, 'learning_rate': 1e-05, 'epoch': 2.7}
{'loss': 1.0217, 'grad_norm': 5.753545761108398, 'learning_rate': 1e-05, 'epoch': 2.8}
{'loss': 1.0223, 'grad_norm': 4.590961456298828, 'learning_rate': 1e-05, 'epoch': 2.9}
{'loss': 1.0442, 'grad_norm': 2.521195888519287, 'learning_rate': 1e-05, 'epoch': 3.0}
{'eval_loss': 0.7673596739768982, 'eval_wer': 0.3952940236497283, 'eval_runtime': 1529.011, 'eval_samples_per_second': 5.232, 'eval_steps_per_second': 5.232, 'epoch': 3.0}
{'train_runtime': 5079.3825, 'train_samples_per_second': 125.968, 'train_steps_per_second': 3.937, 'train_loss': 1.350332896788915, 'epoch': 3.0}
[ASR][Trainer Eval] {'eval_loss': 0.7673596739768982, 'eval_wer': 0.3952940236497283, 'eval_runtime': 1535.0963, 'eval_samples_per_second': 5.211, 'eval_steps_per_second': 5.211, 'epoch': 3.0}
[SER] Skipped (phase != 'all'/'ser').
r23g0005:255432:255567 [0] NCCL INFO [Service thread] Connection closed by localRank 0
r23g0005:255432:391869 [0] NCCL INFO comm 0x55cf41eb0b70 rank 0 nranks 1 cudaDev 0 busId 9d000 - Abort COMPLETE
[TRAIN][SER] Starting SER phase ...
[Setup] Using device: cuda
[Setup] no_cuda flag set to: False
[ASR] Skipped (phase != 'all'/'asr').
[SER] Loading model + extractor‚Ä¶
[SER] Starting from pretrained: models/pretrained/en
trainable params: 1,327,104 || all params: 96,295,560 || trainable%: 1.3782
[SER] Trainable parameters: 1327104 / 96295560
[SER] tensors requiring grad: 144
[SER] truncating to 102719 frames (~6.42s)
[SER] class counts: {4: 6792, 7: 1408, 3: 5556, 5: 6384, 0: 6044, 2: 4140, 1: 3500, 6: 768}
[SER] class weights: [0.7154202461242676, 1.2354285717010498, 1.0444444417953491, 0.7782577276229858, 0.6366313099861145, 0.677318274974823, 5.630208492279053, 3.0710227489471436]
[SER] Sanity loss (1 batch): 2.087580442428589
[SER] Starting training with HuggingFace Trainer‚Ä¶
r23g0005:392005:392005 [0] NCCL INFO Bootstrap : Using ib0:134.61.46.209<0>
r23g0005:392005:392005 [0] NCCL INFO NET/Plugin : dlerror=libnccl-net.so: cannot open shared object file: No such file or directory No plugin found (libnccl-net.so), using internal implementation
r23g0005:392005:392005 [0] NCCL INFO cudaDriverVersion 12080
NCCL version 2.20.5+cuda12.4
r23g0005:392005:405023 [0] NCCL INFO NET/IB : Using [0]mlx5_0:1/IB [1]mlx5_1:1/IB [RO]; OOB ib0:134.61.46.209<0>
r23g0005:392005:405023 [0] NCCL INFO Using non-device net plugin version 0
r23g0005:392005:405023 [0] NCCL INFO Using network IB
r23g0005:392005:405023 [0] NCCL INFO DMA-BUF is available on GPU device 0
r23g0005:392005:405023 [0] NCCL INFO comm 0x5638013f24f0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0xf614a27ffd7cfc98 - Init START
r23g0005:392005:405023 [0] NCCL INFO comm 0x5638013f24f0 rank 0 nRanks 1 nNodes 1 localRanks 1 localRank 0 MNNVL 0
r23g0005:392005:405023 [0] NCCL INFO Channel 00/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 01/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 02/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 03/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 04/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 05/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 06/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 07/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 08/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 09/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 10/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 11/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 12/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 13/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 14/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 15/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 16/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 17/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 18/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 19/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 20/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 21/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 22/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 23/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 24/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 25/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 26/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 27/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 28/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 29/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 30/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Channel 31/32 :    0
r23g0005:392005:405023 [0] NCCL INFO Trees [0] -1/-1/-1->0->-1 [1] -1/-1/-1->0->-1 [2] -1/-1/-1->0->-1 [3] -1/-1/-1->0->-1 [4] -1/-1/-1->0->-1 [5] -1/-1/-1->0->-1 [6] -1/-1/-1->0->-1 [7] -1/-1/-1->0->-1 [8] -1/-1/-1->0->-1 [9] -1/-1/-1->0->-1 [10] -1/-1/-1->0->-1 [11] -1/-1/-1->0->-1 [12] -1/-1/-1->0->-1 [13] -1/-1/-1->0->-1 [14] -1/-1/-1->0->-1 [15] -1/-1/-1->0->-1 [16] -1/-1/-1->0->-1 [17] -1/-1/-1->0->-1 [18] -1/-1/-1->0->-1 [19] -1/-1/-1->0->-1 [20] -1/-1/-1->0->-1 [21] -1/-1/-1->0->-1 [22] -1/-1/-1->0->-1 [23] -1/-1/-1->0->-1 [24] -1/-1/-1->0->-1 [25] -1/-1/-1->0->-1 [26] -1/-1/-1->0->-1 [27] -1/-1/-1->0->-1 [28] -1/-1/-1->0->-1 [29] -1/-1/-1->0->-1 [30] -1/-1/-1->0->-1 [31] -1/-1/-1->0->-1
r23g0005:392005:405023 [0] NCCL INFO P2P Chunksize set to 131072
r23g0005:392005:405023 [0] NCCL INFO Connected all rings
r23g0005:392005:405023 [0] NCCL INFO Connected all trees
r23g0005:392005:405023 [0] NCCL INFO 32 coll channels, 0 collnet channels, 0 nvls channels, 32 p2p channels, 32 p2p channels per peer
r23g0005:392005:405023 [0] NCCL INFO comm 0x5638013f24f0 rank 0 nranks 1 cudaDev 0 nvmlDev 0 busId 9d000 commId 0xf614a27ffd7cfc98 - Init COMPLETE
{'loss': 2.0808, 'grad_norm': 0.04568813368678093, 'learning_rate': 1.1458333333333333e-06, 'epoch': 0.23}
{'loss': 2.0801, 'grad_norm': 0.05581553652882576, 'learning_rate': 2.3032407407407407e-06, 'epoch': 0.46}
{'loss': 2.0814, 'grad_norm': 0.04960528388619423, 'learning_rate': 3.4606481481481487e-06, 'epoch': 0.69}
{'loss': 2.0799, 'grad_norm': 0.05070754885673523, 'learning_rate': 4.618055555555556e-06, 'epoch': 0.93}
{'eval_loss': 2.0814056396484375, 'eval_accuracy': 0.1701668584579977, 'eval_f1': 0.0513128150314019, 'eval_runtime': 90.1229, 'eval_samples_per_second': 77.139, 'eval_steps_per_second': 77.139, 'epoch': 1.0}
{'loss': 2.081, 'grad_norm': 0.06874732673168182, 'learning_rate': 5.775462962962963e-06, 'epoch': 1.16}
{'loss': 2.0774, 'grad_norm': 0.0911051407456398, 'learning_rate': 6.932870370370371e-06, 'epoch': 1.39}
{'loss': 2.0745, 'grad_norm': 0.11997397989034653, 'learning_rate': 8.090277777777778e-06, 'epoch': 1.62}
{'loss': 2.0695, 'grad_norm': 0.15603476762771606, 'learning_rate': 9.247685185185185e-06, 'epoch': 1.85}
{'eval_loss': 2.084801435470581, 'eval_accuracy': 0.18642117376294592, 'eval_f1': 0.0807283718904791, 'eval_runtime': 91.4153, 'eval_samples_per_second': 76.049, 'eval_steps_per_second': 76.049, 'epoch': 2.0}
{'loss': 2.0635, 'grad_norm': 0.167818084359169, 'learning_rate': 9.954989711934157e-06, 'epoch': 2.08}
{'loss': 2.0509, 'grad_norm': 0.258209228515625, 'learning_rate': 9.826388888888889e-06, 'epoch': 2.31}
{'loss': 2.0408, 'grad_norm': 0.3083740770816803, 'learning_rate': 9.697788065843621e-06, 'epoch': 2.55}
{'loss': 2.0267, 'grad_norm': 0.26706141233444214, 'learning_rate': 9.569187242798355e-06, 'epoch': 2.78}
{'eval_loss': 2.0728049278259277, 'eval_accuracy': 0.11032796317606444, 'eval_f1': 0.0759762057417302, 'eval_runtime': 94.2824, 'eval_samples_per_second': 73.736, 'eval_steps_per_second': 73.736, 'epoch': 3.0}
{'loss': 2.0166, 'grad_norm': 0.32927441596984863, 'learning_rate': 9.440586419753087e-06, 'epoch': 3.01}
{'loss': 2.0069, 'grad_norm': 0.7680187821388245, 'learning_rate': 9.31198559670782e-06, 'epoch': 3.24}
{'loss': 2.0042, 'grad_norm': 0.3603403866291046, 'learning_rate': 9.183384773662552e-06, 'epoch': 3.47}
{'loss': 2.0026, 'grad_norm': 0.355237752199173, 'learning_rate': 9.054783950617286e-06, 'epoch': 3.7}
{'loss': 1.9946, 'grad_norm': 0.4344989061355591, 'learning_rate': 8.926183127572016e-06, 'epoch': 3.94}
{'eval_loss': 2.023930072784424, 'eval_accuracy': 0.15578250863060988, 'eval_f1': 0.09069692459472294, 'eval_runtime': 92.6272, 'eval_samples_per_second': 75.054, 'eval_steps_per_second': 75.054, 'epoch': 4.0}
{'train_runtime': 876.3703, 'train_samples_per_second': 630.784, 'train_steps_per_second': 9.859, 'train_loss': 2.0480543551621615, 'epoch': 4.0}
[SER][Trainer Eval] {'eval_loss': 2.084801435470581, 'eval_accuracy': 0.18642117376294592, 'eval_f1': 0.0807283718904791, 'eval_runtime': 78.5222, 'eval_samples_per_second': 88.535, 'eval_steps_per_second': 88.535, 'epoch': 4.0}
r23g0005:392005:405026 [0] NCCL INFO [Service thread] Connection closed by localRank 0
r23g0005:392005:420972 [0] NCCL INFO comm 0x5638013f24f0 rank 0 nranks 1 cudaDev 0 busId 9d000 - Abort COMPLETE
